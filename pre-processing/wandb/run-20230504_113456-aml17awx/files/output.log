2023-05-04 11:34:59,982 Merging multiple dataframes
/home/orestas41/project-FootballPredict/lithuanian-football-league-predictor/pre-processing/run.py:40: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  data = data.append(df)
/home/orestas41/project-FootballPredict/lithuanian-football-league-predictor/pre-processing/run.py:40: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  data = data.append(df)
/home/orestas41/project-FootballPredict/lithuanian-football-league-predictor/pre-processing/run.py:40: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  data = data.append(df)
/home/orestas41/project-FootballPredict/lithuanian-football-league-predictor/pre-processing/run.py:40: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  data = data.append(df)
/home/orestas41/project-FootballPredict/lithuanian-football-league-predictor/pre-processing/run.py:40: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  data = data.append(df)
/home/orestas41/project-FootballPredict/lithuanian-football-league-predictor/pre-processing/run.py:40: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  data = data.append(df)
2023-05-04 11:35:00,112 Creating dataframe
2023-05-04 11:35:00,133 Removeing rows with missing values
2023-05-04 11:35:00,150 Converting Date column into datetime format
2023-05-04 11:35:00,155 Sorting dataframe by date
2023-05-04 11:35:00,168 Setting Date column as index
2023-05-04 11:35:00,179 Checking if teams are correct. Changing if incorrect
/home/orestas41/project-FootballPredict/lithuanian-football-league-predictor/pre-processing/run.py:72: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df['Home'][i] = df['Home-missing'][i]
/home/orestas41/project-FootballPredict/lithuanian-football-league-predictor/pre-processing/run.py:73: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df['Away'][i] = df['Away-missing'][i]
2023-05-04 11:35:00,313 Checking the teams are on the correct side. Changing if incorrect
/home/orestas41/project-FootballPredict/lithuanian-football-league-predictor/pre-processing/run.py:80: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df['Home'][i] = df['Home-missing'][i]
/home/orestas41/project-FootballPredict/lithuanian-football-league-predictor/pre-processing/run.py:81: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df['Away'][i] = df['Away-missing'][i]
2023-05-04 11:35:00,355 Converting Results columns into separate columns for Home and Away goals
2023-05-04 11:35:00,366 Encoding unique strings
2023-05-04 11:35:00,377 Creating Winner column with the team that won or draw
2023-05-04 11:35:00,433 Dropping unnecessary columns
Traceback (most recent call last):
  File "/home/orestas41/project-FootballPredict/lithuanian-football-league-predictor/pre-processing/run.py", line 180, in <module>
    go(args)
  File "/home/orestas41/project-FootballPredict/lithuanian-football-league-predictor/pre-processing/run.py", line 130, in go
    df = df.drop(['Position', 'Sanity check', 'Home-missing', 'Away-missing', 'Result', 'Unnamed'], axis=1)
  File "/home/orestas41/miniconda3/envs/mlflow-0fb78b63611cf0d39492e26261883faf819037da/lib/python3.10/site-packages/pandas/util/_decorators.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/home/orestas41/miniconda3/envs/mlflow-0fb78b63611cf0d39492e26261883faf819037da/lib/python3.10/site-packages/pandas/core/frame.py", line 4948, in drop
    return super().drop(
  File "/home/orestas41/miniconda3/envs/mlflow-0fb78b63611cf0d39492e26261883faf819037da/lib/python3.10/site-packages/pandas/core/generic.py", line 4279, in drop
    obj = obj._drop_axis(labels, axis, level=level, errors=errors)
  File "/home/orestas41/miniconda3/envs/mlflow-0fb78b63611cf0d39492e26261883faf819037da/lib/python3.10/site-packages/pandas/core/generic.py", line 4323, in _drop_axis
    new_axis = axis.drop(labels, errors=errors)
  File "/home/orestas41/miniconda3/envs/mlflow-0fb78b63611cf0d39492e26261883faf819037da/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 6644, in drop
    raise KeyError(f"{list(labels[mask])} not found in axis")
KeyError: "['Unnamed'] not found in axis"
   Unnamed: 0  Position               Date         Home Result      Away                                       Sanity check Home-missing Away-missing
0           0         1                NaN          NaN    NaN       NaN                                           20 turas          NaN          NaN
1           1         2  2020-11-14, 15:00     Žalgiris  3 : 0    Sūduva  2020-11-14, 15:00\t\tŽalgiris\n\t3 : 0\t\nSūd...     Žalgiris       Sūduva
2           2         3  2020-10-31, 17:00  K. Žalgiris  1 : 0  Riteriai  2020-10-31, 17:00\t\tK. Žalgiris\n\t1 : 0\t\n...  K. Žalgiris  K. Žalgiris
3           3         4  2020-10-31, 17:00    Panevėžys  1 : 1     Banga  2020-10-31, 17:00\t\tPanevėžys\n\t1 : 1\t\nBa...        Banga        Banga
4           4         5                NaN          NaN    NaN       NaN                                           19 turas          NaN          NaN
   Unnamed: 0  Position               Date         Home Result       Away                                       Sanity check Home-missing Away-missing
1           1         2  2020-11-14, 15:00     Žalgiris  3 : 0     Sūduva  2020-11-14, 15:00\t\tŽalgiris\n\t3 : 0\t\nSūd...     Žalgiris       Sūduva
2           2         3  2020-10-31, 17:00  K. Žalgiris  1 : 0   Riteriai  2020-10-31, 17:00\t\tK. Žalgiris\n\t1 : 0\t\n...  K. Žalgiris  K. Žalgiris
3           3         4  2020-10-31, 17:00    Panevėžys  1 : 1      Banga  2020-10-31, 17:00\t\tPanevėžys\n\t1 : 1\t\nBa...        Banga        Banga
5           5         6  2020-10-28, 18:30     Riteriai  1 : 1  Panevėžys  2020-10-28, 18:30\t\tRiteriai\n\t1 : 1\t\nPan...     Riteriai    Panevėžys
6           6         7  2020-10-20, 20:00       Sūduva  1 : 1     Sūduva  2020-10-20, 20:00\t\tSūduva\n\t1 : 1\t\nK. Ža...       Sūduva  K. Žalgiris
     Unnamed: 0  Position                Date         Home Result         Away                                       Sanity check Home-missing Away-missing
910         172       173 2018-02-24 13:00:00       Sūduva  2 : 0     Stumbras  2018-02-24, 13:00\t\tSūduva\n\t2 : 0\t\nStumb...       Sūduva     Stumbras
909         171       172 2018-02-24 15:00:00     Atlantas  0 : 1     Riteriai  2018-02-24, 15:00\t\tRiteriai\n\t0 : 1\t\nAtl...     Riteriai     Atlantas
908         170       171 2018-02-25 13:00:00      Palanga  1 : 1       Jonava  2018-02-25, 13:00\t\tPalanga\n\t1 : 1\t\nJona...      Palanga       Jonava
907         169       170 2018-02-25 18:00:00     Žalgiris  2 : 0  K. Žalgiris  2018-02-25, 18:00\t\tŽalgiris\n\t2 : 0\t\nK. ...     Žalgiris  K. Žalgiris
905         167       168 2018-03-03 13:00:00  K. Žalgiris  1 : 4     Riteriai  2018-03-03, 13:00\t\tK. Žalgiris\n\t1 : 4\t\n...  K. Žalgiris  K. Žalgiris
                     Unnamed: 0  Position         Home Result         Away                                       Sanity check Home-missing Away-missing
Date
2018-02-24 13:00:00         172       173       Sūduva  2 : 0     Stumbras  2018-02-24, 13:00\t\tSūduva\n\t2 : 0\t\nStumb...       Sūduva     Stumbras
2018-02-24 15:00:00         171       172     Atlantas  0 : 1     Riteriai  2018-02-24, 15:00\t\tRiteriai\n\t0 : 1\t\nAtl...     Riteriai     Atlantas
2018-02-25 13:00:00         170       171      Palanga  1 : 1       Jonava  2018-02-25, 13:00\t\tPalanga\n\t1 : 1\t\nJona...      Palanga       Jonava
2018-02-25 18:00:00         169       170     Žalgiris  2 : 0  K. Žalgiris  2018-02-25, 18:00\t\tŽalgiris\n\t2 : 0\t\nK. ...     Žalgiris  K. Žalgiris
2018-03-03 13:00:00         167       168  K. Žalgiris  1 : 4     Riteriai  2018-03-03, 13:00\t\tK. Žalgiris\n\t1 : 4\t\n...  K. Žalgiris  K. Žalgiris
                     Unnamed: 0  Position         Home Result         Away                                       Sanity check Home-missing Away-missing
Date
2018-02-24 13:00:00         172       173       Sūduva  2 : 0     Stumbras  2018-02-24, 13:00\t\tSūduva\n\t2 : 0\t\nStumb...       Sūduva     Stumbras
2018-02-24 15:00:00         171       172     Atlantas  0 : 1     Riteriai  2018-02-24, 15:00\t\tRiteriai\n\t0 : 1\t\nAtl...     Riteriai     Atlantas
2018-02-25 13:00:00         170       171      Palanga  1 : 1       Jonava  2018-02-25, 13:00\t\tPalanga\n\t1 : 1\t\nJona...      Palanga       Jonava
2018-02-25 18:00:00         169       170     Žalgiris  2 : 0  K. Žalgiris  2018-02-25, 18:00\t\tŽalgiris\n\t2 : 0\t\nK. ...     Žalgiris  K. Žalgiris
2018-03-03 13:00:00         167       168  K. Žalgiris  1 : 4     Riteriai  2018-03-03, 13:00\t\tK. Žalgiris\n\t1 : 4\t\n...  K. Žalgiris  K. Žalgiris
                     Unnamed: 0  Position         Home Result         Away                                       Sanity check Home-missing Away-missing
Date
2018-02-24 13:00:00         172       173       Sūduva  2 : 0     Stumbras  2018-02-24, 13:00\t\tSūduva\n\t2 : 0\t\nStumb...       Sūduva     Stumbras
2018-02-24 15:00:00         171       172     Riteriai  0 : 1     Atlantas  2018-02-24, 15:00\t\tRiteriai\n\t0 : 1\t\nAtl...     Riteriai     Atlantas
2018-02-25 13:00:00         170       171      Palanga  1 : 1       Jonava  2018-02-25, 13:00\t\tPalanga\n\t1 : 1\t\nJona...      Palanga       Jonava
2018-02-25 18:00:00         169       170     Žalgiris  2 : 0  K. Žalgiris  2018-02-25, 18:00\t\tŽalgiris\n\t2 : 0\t\nK. ...     Žalgiris  K. Žalgiris
2018-03-03 13:00:00         167       168  K. Žalgiris  1 : 4     Riteriai  2018-03-03, 13:00\t\tK. Žalgiris\n\t1 : 4\t\n...  K. Žalgiris  K. Žalgiris
                     Unnamed: 0  Position         Home Result         Away                                       Sanity check Home-missing Away-missing  homeResult  awayResult
Date
2018-02-24 13:00:00         172       173       Sūduva  2 : 0     Stumbras  2018-02-24, 13:00\t\tSūduva\n\t2 : 0\t\nStumb...       Sūduva     Stumbras           2           0
2018-02-24 15:00:00         171       172     Riteriai  0 : 1     Atlantas  2018-02-24, 15:00\t\tRiteriai\n\t0 : 1\t\nAtl...     Riteriai     Atlantas           0           1
2018-02-25 13:00:00         170       171      Palanga  1 : 1       Jonava  2018-02-25, 13:00\t\tPalanga\n\t1 : 1\t\nJona...      Palanga       Jonava           1           1
2018-02-25 18:00:00         169       170     Žalgiris  2 : 0  K. Žalgiris  2018-02-25, 18:00\t\tŽalgiris\n\t2 : 0\t\nK. ...     Žalgiris  K. Žalgiris           2           0
2018-03-03 13:00:00         167       168  K. Žalgiris  1 : 4     Riteriai  2018-03-03, 13:00\t\tK. Žalgiris\n\t1 : 4\t\n...  K. Žalgiris  K. Žalgiris           1           4
                     Unnamed: 0  Position         Home Result         Away                                       Sanity check Home-missing Away-missing  homeResult  awayResult
Date
2018-02-24 13:00:00         172       173       Sūduva  2 : 0     Stumbras  2018-02-24, 13:00\t\tSūduva\n\t2 : 0\t\nStumb...       Sūduva     Stumbras           2           0
2018-02-24 15:00:00         171       172     Riteriai  0 : 1     Atlantas  2018-02-24, 15:00\t\tRiteriai\n\t0 : 1\t\nAtl...     Riteriai     Atlantas           0           1
2018-02-25 13:00:00         170       171      Palanga  1 : 1       Jonava  2018-02-25, 13:00\t\tPalanga\n\t1 : 1\t\nJona...      Palanga       Jonava           1           1
2018-02-25 18:00:00         169       170     Žalgiris  2 : 0  K. Žalgiris  2018-02-25, 18:00\t\tŽalgiris\n\t2 : 0\t\nK. ...     Žalgiris  K. Žalgiris           2           0
2018-03-03 13:00:00         167       168  K. Žalgiris  1 : 4     Riteriai  2018-03-03, 13:00\t\tK. Žalgiris\n\t1 : 4\t\n...  K. Žalgiris  K. Žalgiris           1           4
                     Unnamed: 0  Position  Home Result  Away                                       Sanity check  Home-missing  Away-missing  homeResult  awayResult  Winner
Date
2018-02-24 13:00:00         172       173     0  2 : 0     6  2018-02-24, 13:00\t\tSūduva\n\t2 : 0\t\nStumb...             0             6           2           0       0
2018-02-24 15:00:00         171       172     1  0 : 1     7  2018-02-24, 15:00\t\tRiteriai\n\t0 : 1\t\nAtl...             1             7           0           1       7
2018-02-25 13:00:00         170       171     2  1 : 1     5  2018-02-25, 13:00\t\tPalanga\n\t1 : 1\t\nJona...             2             5           1           1      10
2018-02-25 18:00:00         169       170     3  2 : 0     4  2018-02-25, 18:00\t\tŽalgiris\n\t2 : 0\t\nK. ...             3             4           2           0       3
2018-03-03 13:00:00         167       168     4  1 : 4     1  2018-03-03, 13:00\t\tK. Žalgiris\n\t1 : 4\t\n...             4             4           1           4       1